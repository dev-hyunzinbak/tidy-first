# 관리

- 코드 정리는 언제 시작하나요?
- 코드 정리는 언제 멈추나요?
- 코드의 구조를 변경하는 코드 정리와 시스템의 동작 변경을 어떻게 결합할 수 있나요?

## 16. 코드 정리 구분

> 코드 정리는 별도의 PR로 만들고, 가급적 PR당 몇 개의 코드 정리만 넣습니다.

작은 PR은 리뷰가 빠르게 진행되며, 변화를 쉽게 만든다.

(코드의 가독성이 중요한 것처럼, PR의 가독성도 중요하다. 하지만 단 한 줄의 코드 정리를 위해 별도의 PR을 만드는 것이 정말 가독성을 향상시키는 방법일지는 고민해 봐야겠다. 책에서 말하는 작은 단위가 어느 정도일까)

## 17. 연쇄적인 정리

코드 정리를 하다보면 계속해서 정리하고 싶은 충동이 들게 되는데, 이러한 충동을 관리하는 것도 코드 정리의 핵심 기술이다.

저자는 이때, 아주 작은 단계로 나누어 코드를 정리하는 것을 권한다.

- 보호 구문
- 안 쓰는 코드
- 대칭으로 맞추기
- 새로운 인터페이스로 기존 루틴 부르기
- 읽는 순서
- 응집도를 높이는 배치
- 설명하는 변수
- 설명하는 상수
- 명시적인 매개변수
- 비슷한 코드끼리
- 도우미 추출(메서드 추출)
- 하나의 더미
- 설명하는 주석
- 불필요한 주석 지우기

코드를 너무 많이, 너무 빠르게 변경하지 않도록 주의할 것

## 18. 코드 정리의 일괄 처리량

- **충돌**
  - 코드 정리 작업이 많을수록 통합 과정에서 지연이 발생할 가능성이 커짐
  - 진행 중인 작업과 충돌할 확률이 높아지며, 병합 비용도 증가함
- **상호작용**
  - 다량의 코드 정리를 한 번에 수행하면 의도치 않게 동작이 변경될 가능성이 있음
  - 코드 정리 간의 상호작용이 많아질수록 병합 비용이 급격히 증가함
- **추측**
  - 향후 코드 변경을 고려해 최소한의 정리를 수행하는 것이 바람직함
  - 하지만 한 번에 많은 정리를 진행하면 예상보다 더 많은 코드가 수정될 수 있음
  - 이로 인해 추가적인 비용이 발생할 가능성이 있음

코드 정리에 대한 부담을 낮추고 싶다면, 정리 작업을 더 자주 수행하여 동작 변경에 필요한 비용을 최소화하라. 이렇게 하면 코드 리뷰에 소요되는 비용도 함께 절감할 수 있다.

## 19. 리듬

> 코드 정리는 분 단위를 유지하되, 한 시간을 넘지 않도록 한다.

동작 변경은 특정 코드 영역에 집중되는 경향이 있다. 파레토 법칙에 따르면 전체 변경 사항의 80%가 특정 20%의 파일에서 발생한다. 코드 정리를 미리 수행하면, 정리된 코드도 자연스럽게 한곳에 모이게 되며, 이는 이후 변경 작업을 수행하기에 최적의 환경을 조성한다.

## 20. 얽힘 풀기

코드를 정리하다 보면 어느 순간 동작을 변경해야 할 상황과 맞닥뜨리게 되는데, 이 과저에서 코드 정리와 변경이 뒤섞이면 관리가 어려워진다.

이럴 땐 과감히 진행 중인 작업을 버리고, 코드 정리를 선행하는 방향으로 다시 시작해보자 작업량은 늘어나지만, 이후 커밋의 일관성이 유지되고 코드 변경도 훨씬 명확해진다.

코드 정리는 실타래처럼 얽힌 문제를 깨달았을 때가 바로 적기다. 더 늦기 전에 정리의 흐름을 잡아두면 변경 작업도 훨씬 수월해진다.

## 21. 코드 정리 시점

### **코드 정리를 해야 할 때**

- 코드 정리하는 데 걸리는 시간이 새로운 기능을 추가하는 시간과 비슷할 때
- 현재 코드의 구조를 충분히 이해하고 있으며, 지금 정리하는 것이 더 적은 비용이 들 때
- 앞으로 해당 코드를 자주 변경할 가능성이 높을 때
- 정리를 하면 코드가 더 명확해지고 유지보수가 쉬워지는 즉각적인 효과를 기대할 수 있을 때
- 코드 정리에 대한 의욕이 생겼을 때 (개발자의 동기 부여도 중요한 요소)

### **코드 정리를 미루는 것이 나을 때**

- 해당 코드를 앞으로 다시 변경할 일이 없을 때
- 설계를 개선하더라도 얻을 것이 없을 때
- 정리해야 할 코드가 너무 많아 보상이 명확하지 않을 때
- 여러 번에 나눠서 정리할 수 있는 경우

### **코드 정리 전략**

- **동작 변경 후 코드 정리:** 코드 변경 범위가 크고, 정리를 미루면 이후 유지보수 비용이 더 커질 것 같을 때
- **코드 정리 후 동작 변경:** 정리를 먼저 하면 변경 작업이 훨씬 쉬워지거나 코드 이해도가 높아질 때
- **정리를 미루는 전략:** 지금 정리하는 것이 부담될 경우, ‘정리할 목록’을 만들어 두고 후속 작업에서 점진적으로 진행

코드 정리는 단순히 깔끔한 코드를 위한 것이 아니라, 유지보수성과 개발 생산성을 높이기 위한 전략적 선택이다. 상황에 맞춰 적절한 시점을 판단하고, 필요한 만큼만 정리하는 것이 가장 효과적인 접근법이다.
